<!DOCTYPE html>
<html lang="en">

  <head>
    <meta http-equiv="refresh" content="3; url=https://materials-science.github.io//" />
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Materials Computation & Modeling


  | Fourthorder

</title>
<meta name="description" content="Materials Computation & Modeling Group of Shenzhen University - leading by Prof. Li Wu.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://cdn.staticfile.org/bootstrap/4.5.3/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.19.1/css/mdb.min.css"/>

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">

<link rel="stylesheet" href="https://cdn.staticfile.org/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<!-- <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> -->

<!-- Code Syntax Highlighting -->
<!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" /> -->

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ”¬</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="https://materials-science.github.io/projects/Fourthorder/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>


  </head>

  <body class="fixed-top-nav sticky-bottom-footer">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://materials-science.github.io//">
       Materials Computation &amp; Modeling
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                Publications
                
              </a>
          </li>
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/to-wtt2022">
                WTT2022
                
              </a>
          </li>
          
          
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      


<div class="post">

  <header class="post-header">
    <h1 class="post-title">Fourthorder</h1>
    <p class="post-description">In analogy with thirdorder.py in ShengBTE, Fourthorder.py is developed to calculate fourth-order interatomic force-constants (4th-IFCs). Please post your questions in the 'Discussion' section of FourPhonon repository.</p>
    
  </header>

  <article>
    <h1 id="fourphonon-an-extension-module-to-shengbte-for-computing-four-phonon-scattering-rates-and-thermal-conductivity">
<code class="language-plaintext highlighter-rouge">FourPhonon</code>: An extension module to <code class="language-plaintext highlighter-rouge">ShengBTE</code> for computing four-phonon scattering rates and thermal conductivity</h1>

<h2 id="authors-and-references-for-fourphonon">Authors and references for <code class="language-plaintext highlighter-rouge">FourPhonon</code>:</h2>

<ul>
  <li>Zherui Han <a href="mailto:zrhan@purdue.edu">zrhan@purdue.edu</a>
</li>
  <li>Xiaolong Yang <a href="mailto:xiaolongyang1990@gmail.com">xiaolongyang1990@gmail.com</a>
</li>
  <li>Wu Li <a href="mailto:wu.li.phys2011@gmail.com">wu.li.phys2011@gmail.com</a>
</li>
  <li>Tianli Feng <a href="mailto:Tianli.Feng2011@gmail.com">Tianli.Feng2011@gmail.com</a>
</li>
  <li>Xiulin Ruan <a href="mailto:ruan@purdue.edu">ruan@purdue.edu</a>
</li>
</ul>

<p>References: please refer to our <a href="https://github.com/FourPhonon" target="_blank" rel="noopener noreferrer">GitHub homepage</a></p>

<ol>
  <li>Feng, T. &amp; Ruan, X. Quantum mechanical prediction of four-phonon scattering rates and reduced thermal conductivity of solids. Phys Rev B <strong>93</strong>, 045202 (2016).</li>
  <li>Feng, T., Lindsay, L. &amp; Ruan, X. Four-phonon scattering significantly reduces intrinsic thermal conductivity of solids. Phys Rev B <strong>96</strong>, 161201 (2017).</li>
  <li>Han, Z., Yang, X., Li, W., Feng, T. &amp; Ruan, X. FourPhonon: An extension module to ShengBTE for computing four-phonon scattering rates and thermal conductivity. Comput Phys Commun <strong>270</strong> (2022) 108179, https://doi.org/10.1016/j.cpc.2021.108179.</li>
</ol>

<h2 id="the-original-authors-of-shengbte-and-references">The original authors of <code class="language-plaintext highlighter-rouge">ShengBTE</code> and references:</h2>

<ul>
  <li>Wu Li <a href="mailto:wu.li.phys2011@gmail.com">wu.li.phys2011@gmail.com</a>
</li>
  <li>JesÃºs Carrete MontaÃ±aÂ <a href="https://bitbucket.org/sousaw/shengbte/src/d1ecffd7d8c43f1746eae47e8ddf2cf537bdcf01/mailto:jcarrete@gmail.com" target="_blank" rel="noopener noreferrer">jcarrete@gmail.com</a>
</li>
  <li>Nebil A. KatchoÂ <a href="https://bitbucket.org/sousaw/shengbte/src/d1ecffd7d8c43f1746eae47e8ddf2cf537bdcf01/mailto:nebil.katcho@gmail.com" target="_blank" rel="noopener noreferrer">nebil.katcho@gmail.com</a>
</li>
  <li>Natalio MingoÂ <a href="https://bitbucket.org/sousaw/shengbte/src/d1ecffd7d8c43f1746eae47e8ddf2cf537bdcf01/mailto:natalio.mingo@cea.fr" target="_blank" rel="noopener noreferrer">natalio.mingo@cea.fr</a>
</li>
</ul>

<p>References: please refer to the ShengBTE <a href="http://www.shengbte.org/how-to-cite" target="_blank" rel="noopener noreferrer">link</a>.</p>

<h2 id="how-to-download-and-compile-fourphonon">How to download and compile <code class="language-plaintext highlighter-rouge">FourPhonon</code>
</h2>

<p><code class="language-plaintext highlighter-rouge">FourPhonon</code> is built within <code class="language-plaintext highlighter-rouge">ShengBTE</code> and updates <code class="language-plaintext highlighter-rouge">ShengBTE</code> to a new version. The codes are hosted at GitHub, and you can download the latest distribution from this repository: <a href="https://github.com/FourPhonon" target="_blank" rel="noopener noreferrer">https://github.com/FourPhonon</a> (you can also find this link from <code class="language-plaintext highlighter-rouge">ShengBTE</code> <a href="http://www.shengbte.org/home" target="_blank" rel="noopener noreferrer">website</a>). The compilation of this new version is the same as the previous <code class="language-plaintext highlighter-rouge">ShengBTE</code>: after setting proper paths in <code class="language-plaintext highlighter-rouge">arch.make</code>, one can then run <code class="language-plaintext highlighter-rouge">make</code> in the <code class="language-plaintext highlighter-rouge">Src</code> subdirectory. An executable <code class="language-plaintext highlighter-rouge">ShengBTE</code> will appear in the root directory of this distribution.</p>

<h2 id="how-to-call-fourphonon-function">How to call <code class="language-plaintext highlighter-rouge">FourPhonon</code> function</h2>

<p>Besides the routine inputs and <code class="language-plaintext highlighter-rouge">CONTROL</code> file of <code class="language-plaintext highlighter-rouge">ShengBTE</code>, <code class="language-plaintext highlighter-rouge">FourPhonon</code> requires a fourth-order force constants and some new flags in <code class="language-plaintext highlighter-rouge">CONTROL</code> file.</p>

<h3 id="4th-ifcs-files-force_constants_4th">4th-IFCs files: FORCE_CONSTANTS_4TH</h3>

<p>This file contains the fourth-order interatomic force constant matrix, and uses a sparse description to save space. To construct 4th-IFCs, one can refer to the <code class="language-plaintext highlighter-rouge">Fourthorder</code> python scripts. The format of this force constants is a direct extension of third-order force constants, and contains <code class="language-plaintext highlighter-rouge">nb</code> blocks of such matrix:</p>

<ul>
  <li>A blank line</li>
  <li>A 1-based sequential index (from 1 to <code class="language-plaintext highlighter-rouge">nb</code>)</li>
  <li>A line with the Cartesian coordinates of the second unit cell in Ã…</li>
  <li>A line with the Cartesian coordinates of the third unit cell in Ã…</li>
  <li>A line with the Cartesian coordinates of the fourth unit cell in Ã…</li>
  <li>A line with the 1-based indices of the four atoms involved, each from 1 to <code class="language-plaintext highlighter-rouge">natoms</code>
</li>
  <li>81 lines of force constant matrix in $\frac{\textrm{eV}}{\textrm{Ã…}^4}$. The indexes at the beginning label the Cartesian axes.</li>
</ul>

<p>An example block of this file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
1
0.0000000000e+00 0.0000000000e+00 0.0000000000e+00
0.0000000000e+00 0.0000000000e+00 0.0000000000e+00
0.0000000000e+00 0.0000000000e+00 0.0000000000e+00
     1      1      1      1
 1  1  1  1       -42.0002584218
 1  1  1  2         0.0000000000
 1  1  1  3         0.0000000000
 1  1  2  1         0.0000000000
 1  1  2  2        40.3875689003
 1  1  2  3         0.0000000000
 1  1  3  1         0.0000000000
 1  1  3  2         0.0000000000
 1  1  3  3        40.3875689003
 1  2  1  1         0.0000000000
 1  2  1  2        40.3875689003
 1  2  1  3         0.0000000000
 1  2  2  1        40.3875689003
 1  2  2  2         0.0000000000
 1  2  2  3         0.0000000000
 1  2  3  1         0.0000000000
 1  2  3  2         0.0000000000
 1  2  3  3         0.0000000000
 1  3  1  1         0.0000000000
 1  3  1  2         0.0000000000
 1  3  1  3        40.3875689003
 1  3  2  1         0.0000000000
 1  3  2  2         0.0000000000
 1  3  2  3         0.0000000000
 1  3  3  1        40.3875689003
 1  3  3  2         0.0000000000
 1  3  3  3         0.0000000000
 2  1  1  1         0.0000000000
 2  1  1  2        40.3875689003
 2  1  1  3         0.0000000000
 2  1  2  1        40.3875689003
 2  1  2  2         0.0000000000
 2  1  2  3         0.0000000000
 2  1  3  1         0.0000000000
 2  1  3  2         0.0000000000
 2  1  3  3         0.0000000000
 2  2  1  1        40.3875689003
 2  2  1  2         0.0000000000
 2  2  1  3         0.0000000000
 2  2  2  1         0.0000000000
 2  2  2  2       -42.0002584218
 2  2  2  3         0.0000000000
 2  2  3  1         0.0000000000
 2  2  3  2         0.0000000000
 2  2  3  3        40.3875689003
 2  3  1  1         0.0000000000
 2  3  1  2         0.0000000000
 2  3  1  3         0.0000000000
 2  3  2  1         0.0000000000
 2  3  2  2         0.0000000000
 2  3  2  3        40.3875689003
 2  3  3  1         0.0000000000
 2  3  3  2        40.3875689003
 2  3  3  3         0.0000000000
 3  1  1  1         0.0000000000
 3  1  1  2         0.0000000000
 3  1  1  3        40.3875689003
 3  1  2  1         0.0000000000
 3  1  2  2         0.0000000000
 3  1  2  3         0.0000000000
 3  1  3  1        40.3875689003
 3  1  3  2         0.0000000000
 3  1  3  3         0.0000000000
 3  2  1  1         0.0000000000
 3  2  1  2         0.0000000000
 3  2  1  3         0.0000000000
 3  2  2  1         0.0000000000
 3  2  2  2         0.0000000000
 3  2  2  3        40.3875689003
 3  2  3  1         0.0000000000
 3  2  3  2        40.3875689003
 3  2  3  3         0.0000000000
 3  3  1  1        40.3875689003
 3  3  1  2         0.0000000000
 3  3  1  3         0.0000000000
 3  3  2  1         0.0000000000
 3  3  2  2        40.3875689003
 3  3  2  3         0.0000000000
 3  3  3  1         0.0000000000
 3  3  3  2         0.0000000000
 3  3  3  3       -42.0002584218
</code></pre></div></div>

<h3 id="flags-in-control-file">Flags in <code class="language-plaintext highlighter-rouge">CONTROL</code> file</h3>

<p>This file contains all the user-specified settings and parameters, including crystal structural information, broadening factor, q-mesh, temperature, etc. To call FourPhonon capabilities, one should add a new <code class="language-plaintext highlighter-rouge">&amp;flags</code> namelist:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">four_phonon</code> (logical, default=.false.): compute four-phonon phase space and four-phonon scattering rates.</li>
</ul>

<p>Here, we show some practical usage of this flag in combination with other existing flags.</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">onlyharmonic=.true.</code> and <code class="language-plaintext highlighter-rouge">four_phonon=.true.</code>: only compute four-phonon phase space</li>
  <li>
<code class="language-plaintext highlighter-rouge">convergence=.false.</code> and <code class="language-plaintext highlighter-rouge">four_phonon=.true.</code>: compute thermal conductivity at RTA level for both three- and four-phonon scatterings</li>
  <li>
<code class="language-plaintext highlighter-rouge">four_phonon=.true.</code>(<code class="language-plaintext highlighter-rouge">convergence</code> is default to be .true.): compute thermal conductivity with three-phonon iterative scheme but treat four-phonon scatterings at RTA level</li>
</ul>

<p>*Note that: all other parameters in <code class="language-plaintext highlighter-rouge">CONTROL</code> file, like temperature or q-mesh, apply to both three- and four-phonon processes. <code class="language-plaintext highlighter-rouge">nanowires</code> function is not supported in <code class="language-plaintext highlighter-rouge">FourPhonon</code> package.</p>

<h2 id="output-files">Output files</h2>

<p>Besides the routine output files from previous <code class="language-plaintext highlighter-rouge">ShengBTE</code> program, <code class="language-plaintext highlighter-rouge">FourPhonon</code> generates these output files:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.Numprocess_4ph</code>: number of allowed four-phonon scattering processes, for each irreducible q point and phonon band</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.P4</code>: phase space available for four-phonon processes, for each irreducible q point and phonon band</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.P4_total</code>: total volume in phase space available for four-phonon processes</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.P4_plusplus*</code>, <code class="language-plaintext highlighter-rouge">BTE.P4_plusminus*</code>, <code class="language-plaintext highlighter-rouge">BTE.P4_minusminus*</code>: similar to BTE.P4 but only includes contributions from ++/+-/- - processes</li>
</ul>

<p>*Note for four-phonon scatterings, there are three different channels: recombination (++), redistribution (+-) and splitting (- -) processes.</p>

<p>Under temperature-dependent directories: (the unit of scattering rates is ps$^{-1}$ if not specified)</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.WP4</code>: weighted phase space available for four-phonon processes ([rad/ps]$^{-5}$, 2nd column) vs angular frequency (rad/ps, 1st column) for each irreducible q point and phonon band</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.WP4_plusplus*</code>, <code class="language-plaintext highlighter-rouge">BTE.WP4_plusminus*</code>, <code class="language-plaintext highlighter-rouge">BTE.WP4_minusminus*</code>: similar to BTE.WP4 but only includes contributions from ++/+-/- - processes</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.w_3ph</code>: three-phonon scattering rates for each irreducible q point and phonon band, this file replaces the original output <code class="language-plaintext highlighter-rouge">BTE.w_anharmonic</code>. Absorption and emission processes are written out into <code class="language-plaintext highlighter-rouge">BTE.w_3ph_plus</code> and <code class="language-plaintext highlighter-rouge">BTE.w_3ph_minus</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.w_4ph</code>: four-phonon scattering rates for each irreducible q point and phonon band. Similarly, we provide the contributions from different channels: <code class="language-plaintext highlighter-rouge">BTE.w_4ph_plusplus</code>, <code class="language-plaintext highlighter-rouge">BTE.w_4ph_plusminus</code> and <code class="language-plaintext highlighter-rouge">BTE.w_4ph_minusminus</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.w_4ph_normal</code>: four-phonon scattering rates of normal processes, for each irreducible q point and phonon band. This file has 5 columns and each one represents: angular frequency in rad/ps, recombination channel, redistribution channel, splitting channel, overall scattering rates from normal processes</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.w_4ph_Umklapp</code>: four-phonon scattering rates of Umklapp processes, for each irreducible q point and phonon band. The format is the same as <code class="language-plaintext highlighter-rouge">BTE.w_4ph_normal</code>
</li>
  <li>
<code class="language-plaintext highlighter-rouge">BTE.kappa*</code>: thermal conductivity results are written out as usual</li>
</ul>

  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="sticky-bottom mt-5">
  <div class="container">
    Â© Copyright 2022   .
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Maintained by <a href="https://github.com/PorYoung/" target="_blank" rel="noopener noreferrer">PorYoung</a>.

    
    
    Last updated: June 24, 2022.
    
  </div>
</footer>



  </body>

  <script src="https://cdn.staticfile.org/jquery/3.5.1/jquery.min.js"></script>

  
<!-- Bootsrap & MDB scripts -->
<script src="https://cdn.bootcdn.net/ajax/libs/popper.js/2.4.4/umd/popper.min.js"></script>
<script src="https://cdn.staticfile.org/bootstrap/4.5.3/js/bootstrap.min.js"></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.19.1/js/mdb.min.js"></script>


  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  
<!-- Enable Tooltips -->
<script type="text/javascript">
$(function () {$('[data-toggle="tooltip"]').tooltip()})
</script>



<!-- Medium Zoom JS -->

<script defer type="text/javascript" id="MathJax-script" src="https://cdn.staticfile.org/medium-zoom/1.0.6/medium-zoom.min.js"></script>


<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>


<script defer type="text/javascript" id="MathJax-script" src="https://cdn.staticfile.org/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>


<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
